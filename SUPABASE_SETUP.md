# خطوة بخطوة: جعل البيانات تظهر على جميع الأجهزة

اتبع الخطوات بالترتيب. بعد الانتهاء، بيانات النوادي والحجوزات ستُزامن تلقائياً بين الكمبيوتر والجوال وأي جهاز يفتح التطبيق (محلياً أو من Vercel).

---

## الخطوة 1: إنشاء حساب ومشروع Supabase

1. افتح المتصفح وادخل إلى: **https://supabase.com**
2. اضغط **Start your project** (أو Sign in إن كان لديك حساب).
3. سجّل الدخول بحساب GitHub أو بريدك الإلكتروني.
4. من لوحة التحكم اضغط **New Project**.
5. اختر **Organization** (أو أنشئ واحدة)، ثم:
   - **Name**: مثلاً `padel-app`
   - **Database Password**: اختر كلمة مرور قوية واحفظها (للداتابيز فقط).
   - **Region**: اختر الأقرب لك.
6. اضغط **Create new project** وانتظر حتى يكتمل الإعداد (دقيقة أو اثنتين).

---

## الخطوة 2: نسخ رابط المشروع والمفتاح العام (API)

1. في نفس المشروع من القائمة اليسرى اضغط أيقونة **الإعدادات (Settings)** أسفل يسار الصفحة.
2. من القائمة اختر **API**.
3. ستجد:
   - **Project URL** — انسخه (مثل: `https://abcdefgh.supabase.co`).
   - **Project API keys** — انسخ المفتاح تحت **anon** **public** (سطر طويل يبدأ بحروف وأرقام).

احتفظ بهذين النصين؛ ستضعهما في الخطوة 4 و 5.

---

## الخطوة 3: إنشاء جدول التخزين في Supabase

1. من القائمة اليسرى في Supabase اضغط **SQL Editor**.
2. اضغط **New query**.
3. الصق الكود التالي **بالكامل** في النافذة:

```sql
create table if not exists app_store (
  key   text primary key,
  value jsonb not null default '[]'::jsonb
);

alter table app_store enable row level security;

create policy "Allow anonymous read and write for app_store"
  on app_store for all
  using (true)
  with check (true);
```

4. اضغط **Run** (أو Ctrl+Enter).
5. تأكد أن تظهر رسالة نجاح (مثل: Success. No rows returned). هذا يعني أن الجدول `app_store` جاهز.
6. **تفعيل التحديث الفوري (اختياري لكن مُفضّل):** من القائمة اليسرى اختر **Database** ثم **Replication**. ابحث عن الجدول **app_store** وفعّل له **Replication** (أو **Enable Realtime**). بهذا عندما يضيف أحد بيانات من جهاز آخر ستُحدَّث عندك تلقائياً دون تحديث الصفحة.

---

## الخطوة 4: إضافة المتغيرات على جهازك (التشغيل المحلي)

1. افتح مجلد المشروع على جهازك: `c:\padel\padel`
2. أنشئ ملفاً اسمه **`.env.local`** في نفس المجلد الذي فيه `package.json` (إن لم يكن موجوداً).
3. افتح الملف واكتب السطرين التاليين (واستبدل القيم بما نسخته من Supabase):

```env
VITE_SUPABASE_URL=https://xxxxx.supabase.co
VITE_SUPABASE_ANON_KEY=المفتاح_الطويل_الذي_نسخته_تحت_anon
```

- استبدل `https://xxxxx.supabase.co` بـ **Project URL** من الخطوة 2.
- استبدل `المفتاح_الطويل_الذي_نسخته_تحت_anon` بـ **anon public** key من الخطوة 2.

4. احفظ الملف وأغلق المحرر.

الآن عند تشغيل التطبيق محلياً (`npm run dev`) ستُزامن البيانات مع Supabase.

---

## الخطوة 5: إضافة المتغيرات في Vercel (حتى تظهر البيانات على الموقع المنشور)

1. ادخل إلى **https://vercel.com** وسجّل الدخول.
2. اختر المشروع الخاص بتطبيق البادل (الذي ينشر منه الموقع).
3. من أعلى الصفحة اضغط **Settings**.
4. من القائمة اليسرى اختر **Environment Variables**.
5. أضف متغيرين:

   **المتغير الأول:**
   - **Key**: `VITE_SUPABASE_URL`
   - **Value**: نفس **Project URL** الذي استخدمته في الخطوة 4 (مثل `https://abcdefgh.supabase.co`).
   - اختر البيئات: Production و Preview و Development (أو على الأقل Production).
   - اضغط **Save**.

   **المتغير الثاني:**
   - **Key**: `VITE_SUPABASE_ANON_KEY`
   - **Value**: نفس مفتاح **anon public** الذي استخدمته في الخطوة 4.
   - اختر نفس البيئات.
   - اضغط **Save**.

6. من تبويب **Deployments** اضغط على النقاط الثلاث بجانب آخر نشر واختر **Redeploy** (أو انشر من جديد من Git). هذا ضروري حتى يقرأ Vercel المتغيرات الجديدة.

7. **مهم:** عند إضافة المتغيرين، تأكد أنك اخترت بيئة **Production** (وليس Preview فقط)، لأن الرابط العام (مثل `https://padel-ecru-delta.vercel.app`) يعتمد على نشر Production. إذا كانت البيانات تختلف بين المستخدمين، غالباً المتغيرات غير مضبوطة لـ Production أو لم يُعاد النشر بعد إضافتها.

بعد إعادة النشر، الموقع المنشور على Vercel سيستخدم Supabase وستظهر نفس البيانات على جميع الأجهزة التي تفتح الموقع.

---

## التحقق أن كل شيء يعمل

1. **محلياً**: شغّل `npm run dev` وافتح التطبيق، أضف نادياً أو عدّل بيانات ثم احفظ.
2. **على جهاز آخر أو جوال**: افتح نفس الموقع المنشور على Vercel (أو افتح التطبيق المحلي من جهاز آخر على نفس الشبكة إن كان يعمل كذلك). تأكد أن النادي أو التعديلات تظهر.

إذا ظهرت البيانات نفسها على الجهازين، فالمزامنة تعمل والبيانات ستظهر على جميع الأجهزة كما طلبت.

---

## جعل المشروع عاماً للجميع (GitHub + Vercel)

### GitHub — جعل المستودع عاماً
1. ادخل إلى المستودع على **https://github.com** (مثلاً `yakhawaji-lang/padel`).
2. اضغط **Settings** (إعدادات المستودع).
3. في الأسفل تحت **Danger Zone** اضغط **Change visibility**.
4. اختر **Make public** وأكّد. بعدها أي شخص يستطيع تصفح الكود واستنساخه (clone).

### Vercel — الرابط العام الثابت (Production)
- الرابط الذي فيه جزء عشوائي مثل `padel-kt8zg6s8s-yahyas-projects-xxx.vercel.app` هو رابط **معاينة (Preview)** وليس الرابط الثابت.
- الرابط **العام للجميع** هو رابط **الإنتاج (Production)**، وهو عادةً: `https://اسم-المشروع.vercel.app` (بدون الجزء العشوائي).
- **كيف تحصل عليه:** في Vercel → مشروعك → **Settings** → **Domains**، أو من **Deployments** اختر النشر الذي عليه علامة **Production** وانسخ رابطه (يكون أقصر وبدون كود المعاينة).
- تأكد أن متغيرات البيئة (`VITE_SUPABASE_URL`, `VITE_SUPABASE_ANON_KEY`) مضبوطة لبيئة **Production** حتى يعمل Supabase للجميع عند فتح الرابط الثابت.

**للمشاركة:** شارك رابط **Production** (مثل `https://padel.vercel.app`) لأي شخص؛ من يفتحه يستطيع تصفح نظام البادل وتحديث البيانات، والبيانات تُزامن للجميع عبر Supabase.

---

## رفع المشروع على GitHub و Vercel

بعد أي تعديل على المشروع (مثل إضافة نظام العروض أو غيره)، حتى يظهر على الموقع المنشور (Vercel) يجب:

1. **رفع الكود إلى GitHub** (من الطرفية على جهازك):
   ```bash
   cd c:\padel\padel
   git add .
   git commit -m "وصف التعديل مثلاً: إضافة نظام العروض"
   git push origin main
   ```
2. إذا كان المشروع مربوطاً بـ Vercel، النشر سيُحدَّث تلقائياً بعد الـ push. إذا لم يحدث نشر تلقائي، ادخل إلى **vercel.com** → مشروعك → **Deployments** واضغط **Redeploy** على آخر نشر (Production).
3. **مهم:** متغيرات البيئة في Vercel (الخطوة 5) يجب أن تكون مضبوطة لـ **Production** ثم **Redeploy** حتى يعمل Supabase على الرابط العام.

---

## ملاحظة

- إذا **لم** تضف `VITE_SUPABASE_URL` و `VITE_SUPABASE_ANON_KEY`، التطبيق يعمل كالسابق ويخزن في **localStorage** فقط (كل جهاز لوحده).
- بعد تنفيذ الخطوات أعلاه، التطبيق يحمّل من Supabase عند الفتح ويحفظ فيها عند كل تعديل، لذلك تظهر البيانات على جميع الأجهزة.
